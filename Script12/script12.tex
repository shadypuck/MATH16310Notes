\documentclass[../main.tex]{subfiles}

\pagestyle{main}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter}{}}
\setcounter{chapter}{11}

\begin{document}




\chapter{Derivatives}\label{sct:12}
\section{Journal}
\marginnote{3/30:}Throughout this sheet, we let $f:A\to\R$ be a real valued function with domain $A\subset\R$. We also now assume the domain $A\subset\R$ is open.
\begin{definition}\label{dfn:12.1}
    The \textbf{derivative} of $f$ at a point $a\in A$ is the number $f'(a)$ defined by the limit
    \begin{equation*}
        f'(a) = \lim_{h\to 0}\frac{f(a+h)-f(a)}{h}
    \end{equation*}
    provided that the limit on the right-hand side exists. If $f'(a)$ exists, we say that $f$ is \textbf{differentiable} (at $a$). If $f$ is differentiable at all points of its domain, we say that $f$ is \textbf{differentiable}. In this case, the values $f'(a)$ define a new function $f':A\to\R$ called the \textbf{derivative} (of $f$).
\end{definition}

\begin{remark}\label{rmk:12.2}
    If $A$ is not open, the limit in Definition \ref{dfn:12.1} may not exist. For example, if $f:[a,b]\to\R$, then we cannot define the derivative at the endpoints. For any $c$ in the domain of $f$, we define the \textbf{right-hand derivative} $f'_+(c)$ and the \textbf{left-hand derivative} $f'_-(c)$ by
    \begin{align*}
        f'_+(c) &= \lim_{h\to 0^+}\frac{f(c+h)-f(c)}{h}&
        f'_-(c) &= \lim_{h\to 0^-}\frac{f(c+h)-f(c)}{h}
    \end{align*}
    We say that $f$ is \textbf{differentiable} (on $[a,b]$) if $f$ is differentiable on $(a,b)$ and $f'_+(a)$ and $f'_-(b)$ exist.
\end{remark}

% Take out exercise in preamble!!!
\begin{lemma}\label{lem:12.3}
    Let $a\in\R$. Then
    \begin{equation*}
        \lim_{x\to a}f(x) = \lim_{h\to 0}f(a+h)
    \end{equation*}
    assuming that one of the two limits exists. (So if the limit on the left exists, so does the one on the right, and they are equal. Similarly, if the limit on the right exists, then so does the one on the left, and they are equal.)
    \begin{proof}
        Suppose first that $\lim_{x\to a}f(x)$ exists, and let it be equal to $L$. To prove that $\lim_{h\to 0}f(a+h)$ exists and that it equals $\lim_{x\to a}f(x)$, Definition \ref{dfn:11.1} tells us that it will suffice to show that for every $\epsilon>0$, there exists a $\delta>0$ such that if $(h+a)\in A$ and $0<|h-0|=|h|<\delta$, then $|f(a+h)-L|<\epsilon$. Let $\epsilon>0$ be arbitrary. Since $\lim_{x\to a}f(x)$ exists, Definition \ref{dfn:11.1} implies that there exists a $\delta>0$ such that if $x\in A$ and $0<|x-a|<\delta$, then $|f(x)-L|<\epsilon$. We will choose this $\delta$ to be our $\delta$. Now suppose that $h$ is any number satisfying both $(h+a)\in A$ and $0<|h|<\delta$; we seek to show that $|f(a+h)-L|<\epsilon$. Since $(h+a)\in A$, $h+a=x$ for some $x\in A$. It follows that $h=x-a$, meaning that $x$ is an object that is both an element of $A$ and that satisfies $0<|h|=|x-a|<\delta$, so we know that $|f(a+h)-L|=|f(x)-L|<\epsilon$, as desired.\par
        The proof is symmetric in the other direction.
    \end{proof}
\end{lemma}

\begin{theorem}\label{trm:12.4}
    Let $a\in\R$. Then $f$ is differentiable at $a$ if and only if $\lim_{x\to a}\frac{f(x)-f(a)}{x-a}$ exists. Moreover, if $f$ is differentiable at $a$, then the derivative of $f$ at $a$ is given by the limit
    \begin{equation*}
        f'(a) = \lim_{x\to a}\frac{f(x)-f(a)}{x-a}
    \end{equation*}
    \begin{proof}
        Suppose first that $f$ is differentiable at $a$. Then by Definition \ref{dfn:12.1}, $f'(a)$ exists. It follows that
        \begin{align*}
            f'(a) &= \lim_{h\to 0}\frac{f(a+h)-f(a)}{h}\tag*{Definition \ref{dfn:12.1}}\\
            &= \lim_{h\to 0}\frac{f(a+h)-f(a)}{(a+h)-a}\\
            &= \lim_{x\to a}\frac{f(x)-f(a)}{x-a}\tag*{Lemma \ref{lem:12.3}}
        \end{align*}
        Note that the substitution in the last step follows from using $\tilde{f}(x)=\frac{f(x)-f(a)}{x-a}$ as the "$f(x)$" function in Lemma \ref{lem:12.3}.\par
        The proof is symmetric in the reverse direction.
    \end{proof}
\end{theorem}

\begin{theorem}\label{trm:12.5}
    If $f$ is differentiable at $a$, then $f$ is continuous at $a$.
    \begin{proof}
        To prove that $f$ is continuous at $a$, Theorem \ref{trm:11.5} tells us that it will suffice to show that $\lim_{x\to a}f(x)=f(a)$. By Definition \ref{dfn:12.1}, the hypothesis implies that $f'(a)$ exists. Additionally, by Exercise \ref{exr:11.6}, $g(x)=x-a$ is continuous at $a$. Thus, by Theorem \ref{trm:11.5}, $\lim_{x\to a}g(x)$ exists (and equals $g(a)$). Consequently, knowing that both $\lim_{x\to a}\frac{f(x)-f(a)}{x-a}$ and $\lim_{x\to a}g(x)$ exist (the former by Theorem \ref{trm:12.4}), we have by Theorem \ref{trm:11.9} that the limit of their product exists and equals
        \begin{align*}
            \lim_{x\to a}\left( \frac{f(x)-f(a)}{x-a}\cdot(x-a) \right) = \lim_{x\to a}(f(x)-f(a))
        \end{align*}
        Moreover, since $g$ is continuous at $a$, $\lim_{x\to a}g(x)=g(a)=a-a=0$. Thus,
        \begin{align*}
            \lim_{x\to a}(f(x)-f(a)) &= \left( \lim_{x\to a}\frac{f(x)-f(a)}{x-a} \right)\left( \lim_{x\to a}(x-a) \right)\\
            &= \left( \lim_{x\to a}\frac{f(x)-f(a)}{x-a} \right)\cdot 0\\
            &= 0
        \end{align*}
        But then it follows by Theorem \ref{trm:11.9} if we consider $f(a)$ to be a constant function that
        \begin{align*}
            \lim_{x\to a}(f(x)-f(a))+f(a) &= 0+f(a)\\
            \lim_{x\to a}(f(x)-f(a)+f(a)) &= f(a)\\
            \lim_{x\to a}f(x) &= f(a)
        \end{align*}
        as desired.
    \end{proof}
\end{theorem}

\begin{exercise}\label{exr:12.6}
    Show that the converse of Theorem \ref{trm:12.5} is not true.
    \begin{proof}
        % Consider the absolute value function (Exercise \ref{exr:11.7}).

        The converse of Theorem \ref{trm:12.5} asserts that "if $f$ is continuous at $a$, then $f$ is differentiable at $a$." To falsify this statement, we will use the absolute value function $|x|$ as a counterexample. Let's begin.\par
        By Exercise \ref{exr:11.7}, $|x|$ is continuous. It follows by Theorem \ref{trm:9.10} that $|x|$ is continuous at 0. However, we can show that $|x|$ is not differentiable at 0.\par
        To do this, Definition \ref{dfn:12.1} and Theorem \ref{trm:12.4} tell us that it will suffice to verify that $\lim_{x\to 0}\frac{|x|-|0|}{x-0}=\lim_{x\to 0}\frac{|x|}{x}$ does not exist. Suppose for the sake of contradiction that $\lim_{x\to 0}\frac{|x|}{x}=L$. Then by Definition \ref{dfn:11.1}, for $\epsilon=1>0$, there exists a $\delta>0$ such that if $0<|x-0|=|x|<\delta$, then $|\frac{|x|}{x}-L|<1$. However, we can show that no such $\delta$ exists. Let $\delta>0$ be arbitrary. By Theorem \ref{trm:5.2}, there exists a number $x\in\R$ such that $0<x<\delta$. It follows by Definition \ref{dfn:8.4} and Exercise \ref{exr:8.5} that $0<|x|=|-x|<\delta$. Since both $x$ and $-x$ are in the appropriate range, we know that
        \begin{align*}
            \left| \frac{|x|}{x}-L \right| &= \left| \frac{x}{x}-L \right|&
                \left| \frac{|-x|}{-x}-L \right| &= \left| \frac{x}{-x}-L \right|\tag*{Definition \ref{dfn:8.4}}\\
            &= |1-L|&
                &= |-1-L|\tag*{Script \ref{sct:7}}\\
            &= |L-1|&
                &= |L+1|\tag*{Exercise \ref{exr:8.5}}\\
            &< 1&
                &< 1
        \end{align*}
        By consecutive applications of the lemma from Exercise \ref{exr:8.9}, it follows that
        \begin{align*}
            -1 &< L-1 < 1&
                -1 &< L+1 < 1\\
            0 &< L < 2&
                -2 &< L < 0
        \end{align*}
        But this implies that $L<0$ and $L>0$, a contradiction.
    \end{proof}
\end{exercise}

\begin{exercise}\label{exr:12.7}
    Show that for all $n\in\N$,
    \begin{equation*}
        x^n-a^n = (x-a)\left( x^{n-1}+ax^{n-2}+a^2x^{n-3}+\cdots+a^{n-2}x+a^{n-1} \right)
    \end{equation*}
    or equivalently,
    \begin{equation*}
        x^n-a^n = (x-a)\left( \sum_{i=0}^{n-1}x^{n-1-i}a^i \right)
    \end{equation*}
    \begin{proof}
        By simple algebra (see Script \ref{sct:7}), we have
        \begin{align*}
            (x-a)\left( \sum_{i=0}^{n-1}x^{n-1-i}a^i \right) &= \sum_{i=0}^{n-1}(x-a)x^{n-1-i}a^i\\
            &= \sum_{i=0}^{n-1}\left( x^{n-i}a^i-x^{n-1-i}a^{i+1} \right)\\
            &= x^n+\sum_{i=1}^{n-1}x^{n-i}a^i-\sum_{i=0}^{n-2}x^{n-1-i}a^{i+1}-a^n\\
            &= x^n+\sum_{i=1}^{n-1}x^{n-i}a^i-\sum_{i=0+1}^{n-2+1}x^{n-1-(i-1)}a^{(i-1)+1}-a^n\\
            &= x^n+\sum_{i=1}^{n-1}x^{n-i}a^i-\sum_{i=1}^{n-1}x^{n-i}a^i-a^n\\
            &= x^n-a^n
        \end{align*}
    \end{proof}
\end{exercise}

\begin{exercise}\label{exr:12.8}\leavevmode
    \begin{enumerate}[label={(\alph*)}]
        \item Let $n\in\N$. Suppose $f:\R\to\R$ is given by $f(x)=x^n$. Use Exercise \ref{exr:12.7} to prove that $f'(a)=na^{n-1}$ for all $a\in\R$.
        \begin{proof}
            To prove that $f'(a)=na^{n-1}$ for all $a\in\R$, Theorem \ref{trm:12.4} tell us that it will suffice to show that $\lim_{x\to a}\frac{f(x)-f(a)}{x-a}=na^{n-1}$ for all $a\in\R$. Let $a$ be an arbitrary element of $\R$. By Corollary \ref{cly:11.12}, the polynomial $\sum_{i=0}^{n-1}x^{n-1-i}a^i$ is continuous. Thus, by Theorem \ref{trm:9.10}, it is continuous at $a$. It follows by Theorem \ref{trm:11.5} that $\lim_{x\to a}\sum_{i=0}^{n-1}x^{n-1-i}a^i=\sum_{i=0}^{n-1}a^{n-1-i}a^i$. Therefore,
            \begin{align*}
                na^{n-1} &= \underbrace{a^{n-1}+\cdots+a^{n-1}}_{n\text{ times}}\\
                &= \sum_{i=0}^{n-1}a^{n-1}\\
                &= \sum_{i=1}^{n-1}a^{n-1-i}a^i\\
                &= \lim_{x\to a}\sum_{i=0}^{n-1}x^{n-1-i}a^i\\
                &= \lim_{x\to a}\frac{x-a}{x-a}\cdot\sum_{i=0}^{n-1}x^{n-1-i}a^i
                \intertext{Note that we can make the above change because $\frac{x-a}{x-a}=1$ for all $x$ satisfying $0<|x-a|<\delta$, whatever $\delta$ may be.}
                &= \lim_{x\to a}\frac{x^n-a^n}{x-a}\tag*{Exercise \ref{exr:12.7}}\\
                &= \lim_{x\to a}\frac{f(x)-f(a)}{x-a}\\
                &= f'(a)\tag*{Theorem \ref{trm:12.4}}
            \end{align*}
            as desired.
        \end{proof}
        \item Let $k\in\R$. Prove that if $f:\R\to\R$ is given by $f(x)=k$, then $f'(a)=0$ for all $a\in\R$.
        \begin{proof}
            To prove that $f'(a)=0$ for all $a\in\R$, Definition \ref{dfn:12.1} tells us that it will suffice to show that $\lim_{h\to 0}\frac{f(a+h)-f(a)}{h}=0$ for all $a\in\R$. Let $a$ be an arbitrary element of $\R$. By Exercise \ref{exr:11.6}, the function $g(x)=0$ is continuous. Thus, by Theorem \ref{trm:9.10}, it is continuous at $a$. It follows by Theorem \ref{trm:11.5} that $\lim_{h\to 0}g(h)=g(0)=0$. Therefore,
            \begin{align*}
                0 &= \lim_{h\to 0}g(h)\\
                &= \lim_{h\to 0}0\\
                &= \lim_{h\to 0}\frac{h}{h}\cdot 0
                \intertext{Note that we can make the above change for the same reason as part (a).}
                &- \lim_{h\to 0}\frac{0}{h}\\
                &= \lim_{h\to 0}\frac{k-k}{h}\\
                &= \lim_{h\to 0}\frac{f(a+h)-f(a)}{h}
            \end{align*}
            as desired.
        \end{proof}
    \end{enumerate}
\end{exercise}

\begin{exercise}\label{exr:12.9}
    Suppose that $f:A\to\R$ and $g:A\to\R$ are differentiable at $a\in A$.
    \begin{enumerate}[label={(\alph*)}]
        \item Prove that $f+g$ is differentiable at $a$ and compute $(f+g)'(a)$ in terms of $f'(a)$ and $g'(a)$.
        \begin{proof}
            To prove that $f+g$ is differentiable at $a$, Definition \ref{dfn:12.1} tells us that it will suffice to show $\lim_{h\to 0}\frac{(f+g)(a+h)-(f+g)(a)}{h}$ exists. Since $f,g$ are differentiable at $a$, we know by Definition \ref{dfn:12.1} that $\lim_{h\to 0}\frac{f(a+h)-f(a)}{h}$ and $\lim_{h\to 0}\frac{g(a+h)-g(a)}{h}$ exist. Thus, by Theorem \ref{trm:11.9} the limit of their sum exists and equals
            \begin{align*}
                \lim_{h\to 0}\left( \frac{f(a+h)-f(a)}{h}+\frac{g(a+h)-g(a)}{h} \right) &= \lim_{h\to 0}\frac{f(a+h)+g(a+h)-f(a)-g(a)}{h}\\
                &= \lim_{h\to 0}\frac{(f+g)(a+h)-(f+g)(a)}{h}
            \end{align*}
            as desired. Having established that $\lim_{h\to 0}\frac{(f+g)(a+h)-(f+g)(a)}{h}$ exists, $(f+g)'(a)$ can be computed in terms of $f'(a)$ and $g'(a)$ with the following algebra.
            \begin{align*}
                (f+g)'(a) &= \lim_{h\to 0}\frac{(f+g)(a+h)-(f+g)(a)}{h}\tag*{Definition \ref{dfn:12.1}}\\
                &= \lim_{h\to 0}\left( \frac{f(a+h)-f(a)}{h}+\frac{g(a+h)-g(a)}{h} \right)\\
                &= \lim_{h\to 0}\frac{f(a+h)-f(a)}{h}+\lim_{h\to 0}\frac{g(a+h)-g(a)}{h}\tag*{Theorem \ref{trm:11.9}}\\
                &= f'(a)+g'(a)\tag*{Definition \ref{dfn:12.1}}
            \end{align*}
        \end{proof}
        \item Prove that $fg$ is differentiable and compute $(fg)'(a)$ in terms of $f(a)$, $g(a)$, $f'(a)$, and $g'(a)$.
        \begin{proof}
            To prove that $fg$ is differentiable at $a$, Definition \ref{dfn:12.1} tells us that it will suffice to show $\lim_{h\to 0}\frac{(fg)(a+h)-(fg)(a)}{h}$ exists. Since $f,g$ are differentiable at $a$, we know by Definition \ref{dfn:12.1} that $\lim_{h\to 0}\frac{f(a+h)-f(a)}{h}$ and $\lim_{h\to 0}\frac{g(a+h)-g(a)}{h}$ exist. For the same reason, we know by Theorem \ref{trm:12.5} that $g$ is continuous, i.e., continuous at $a$ by Theorem \ref{trm:9.10}. Consequently, by Theorem \ref{trm:11.5}, $\lim_{x\to a}g(x)$ exists (and equals $g(a)$). Note that the preceding limit is equal to $\lim_{h\to 0}g(a+h)$ by Lemma \ref{lem:12.3}. Lastly, we have by Exercise \ref{exr:11.6} that the constant function $f(a)$ is continuous at 0. Consequently, by Theorem \ref{trm:11.5}, $\lim_{h\to 0}f(a)$ exists (and equals $f(a)$). Combining all of these results, consecutive applications of Theorem \ref{trm:11.9} assert that the limits
            \begin{align*}
                \lim_{h\to 0}g(a+h)\cdot\frac{f(a+h)-f(a)}{h}&&
                \lim_{h\to 0}f(a)\cdot\frac{g(a+h)-g(a)}{h}
            \end{align*}
            exist. Furthermore, it asserts that the limit of their sum exists and equals
            \begin{align*}
                \lim_{h\to 0}\left( g(a+h)\cdot\frac{f(a+h)-f(a)}{h}+f(a)\cdot\frac{g(a+h)-g(a)}{h} \right)\\
                &\hspace{-5cm}= \lim_{h\to 0}\frac{g(a+h)(f(a+h)-f(a))+f(a)(g(a+h)-g(a))}{h}\\
                &\hspace{-5cm}= \lim_{h\to 0}\frac{f(a+h)g(a+h)-f(a)g(a+h)+f(a)g(a+h)-f(a)g(a)}{h}\\
                &\hspace{-5cm}= \lim_{h\to 0}\frac{f(a+h)g(a+h)-f(a)g(a)}{h}\\
                &\hspace{-5cm}= \lim_{h\to 0}\frac{(fg)(a+h)-(fg)(a)}{h}
            \end{align*}
            as desired. Having established that $\lim_{h\to 0}\frac{(fg)(a+h)-(fg)(a)}{h}$ exists, $(fg)'(a)$ can be computed in terms of $f(a)$, $g(a)$, $f'(a)$, and $g'(a)$ with the following algebra.
            \begin{align*}
                (fg)'(a) &= \lim_{h\to 0}\frac{(fg)(a+h)-(fg)(a)}{h}\tag*{Definition \ref{dfn:12.1}}\\
                &= \lim_{h\to 0}\left( g(a+h)\cdot\frac{f(a+h)-f(a)}{h}+f(a)\cdot\frac{g(a+h)-g(a)}{h} \right)\\
                &= \lim_{h\to 0}g(a+h)\cdot\lim_{h\to 0}\frac{f(a+h)-f(a)}{h}+\lim_{h\to 0}f(a)\cdot\lim_{h\to 0}\frac{g(a+h)-g(a)}{h}\tag*{Theorem \ref{trm:11.9}}\\
                &= g(a)f'(a)+f(a)g'(a)
            \end{align*}
        \end{proof}
        \item Prove that $\frac{1}{g}$ is differentiable at $a$ (under an appropriate assumption) and compute $(\frac{1}{g})'(a)$ in terms of $g'(a)$ and $g(a)$. What assumption do you need to make?
        \begin{proof}
            Assume, in addition to the fact that $g:A\to\R$ is differentiable at $a\in A$, that $g(a)\neq 0$.\par
            To prove that $\frac{1}{g}$ is differentiable at $a$, Definition \ref{dfn:12.1} tells us that it will suffice to show $\lim_{h\to 0}\frac{(\frac{1}{g})(a+h)-(\frac{1}{g})(a)}{h}$ exists. Since $g$ is differentiable at $a$, we know by Definition \ref{dfn:12.1} that $\lim_{h\to 0}\frac{g(a+h)-g(a)}{h}$ exists. For the same reason, we know by Theorem \ref{trm:12.5} that $g$ is continuous, i.e., continuous at $a$ by Theorem \ref{trm:9.10}. Consequently, by Theorem \ref{trm:11.5}, $\lim_{x\to a}g(x)$ exists (and equals $g(a)$). It follows by Lemma \ref{lem:12.3} that the preceding limit is equal to $\lim_{h\to 0}g(a+h)$. Thus, since it is also equal to $g(a)\neq 0$, we have by Theorem \ref{trm:11.9} that $\lim_{h\to 0}\frac{1}{g}(a+h)$ exists (and equals $\frac{1}{g(a)}$). Lastly, we have by Exercise \ref{exr:11.6} that the constant function $-\frac{1}{g(a)}$ is continuous at 0. Consequently, by Theorem \ref{trm:11.5}, $\lim_{h\to 0}-\frac{1}{g(a)}$ exists (and equals $-\frac{1}{g(a)}$). Combining this with the previous result, Theorem \ref{trm:11.9} asserts that the limit $\lim_{h\to 0}-\frac{1}{g(a+h)g(a)}$ exists (and equals $-\frac{1}{g(a)^2}$). Furthermore, it asserts that the limit of its product with $\lim_{h\to 0}\frac{(\frac{1}{g})(a+h)-(\frac{1}{g})(a)}{h}$ exists and equals
            \begin{align*}
                \lim_{h\to 0}-\frac{1}{g(a+h)g(a)}\cdot\frac{g(a+h)-g(a)}{h} &= \lim_{h\to 0}\frac{\frac{g(a)-g(a+h)}{g(a+h)g(a)}}{h}\\
                &= \lim_{h\to 0}\frac{\frac{1}{g(a+h)}-\frac{1}{g(a)}}{h}\\
                &= \lim_{h\to 0}\frac{(\frac{1}{g})(a+h)-(\frac{1}{g})(a)}{h}
            \end{align*}
            as desired. Having established that $\lim_{h\to 0}\frac{(\frac{1}{g})(a+h)-(\frac{1}{g})(a)}{h}$ exists, $(\frac{1}{g})'(a)$ can be computed in terms of $g(a)$ and $g'(a)$ with the following algebra.
            \begin{align*}
                \left( \frac{1}{g} \right)'(a) &= \lim_{h\to 0}\frac{\left( \frac{1}{g} \right)(a+h)-\left( \frac{1}{g} \right)(a)}{h}\tag*{Definition \ref{dfn:12.1}}\\
                &= \lim_{h\to 0}-\frac{1}{g(a+h)g(a)}\cdot\frac{g(a+h)-g(a)}{h}\\
                &= \lim_{h\to 0}-\frac{1}{g(a+h)g(a)}\cdot\lim_{h\to 0}\frac{g(a+h)-g(a)}{h}\tag*{Theorem \ref{trm:11.9}}\\
                &= -\frac{g'(a)}{g(a)^2}
            \end{align*}
        \end{proof}
        \item Prove that $\frac{f}{g}$ is differentiable at $a$ (under an appropriate assumption) and compute $(\frac{f}{g})'(a)$ in terms of $f(a)$, $g(a)$, $f'(a)$, and $g'(a)$. What assumption do you need to make?
        \begin{proof}
            Assume, in addition to the fact that $g:A\to\R$ is differentiable at $a\in A$, that $g(a)\neq 0$.\par
            It follows by part (c) that $\frac{1}{g}$ is differentiable at $a$, and then by part (b) that $f\cdot\frac{1}{g}=\frac{f}{g}$ is differentiable at $a$.\par
            Having established that $(\frac{f}{g})'(a)$ exists, it can be computed in terms of $f(a)$, $g(a)$, $f'(a)$, and $g'(a)$ with the following algebra.
            \begin{align*}
                \left( \frac{f}{g} \right)'(a) &= \left( f\cdot\frac{1}{g} \right)'(a)\\
                &= f(a)\left( \frac{1}{g} \right)'(a)+f'(a)\left( \frac{1}{g} \right)(a)\\
                &= f(a)\cdot -\frac{g'(a)}{g(a)^2}+\frac{f'(a)g(a)}{g(a)^2}\\
                &= \frac{f'(a)g(a)-f(a)g'(a)}{g(a)^2}
            \end{align*}
        \end{proof}
    \end{enumerate}
\end{exercise}

\marginnote{4/1:}One of the most important results concerning the differentiation of functions is the rule for the derivative of a composition of functions. Let $f:B\to\R,g:A\to\R$ be functions such that $g(A)\subset B$. The composition $(f\circ g)(x)=f(g(x))$ is defined for all $x\in A$.

\begin{theorem}\label{trm:12.10}
    Let $a\in A$, $g:A\to\R$, and $f:I\to\R$ where $I$ is an interval containing $g(A)$. Suppose that $g$ is differentiable at $a$ and $f$ is differentiable at $g(a)$. Then $f\circ g$ is differentiable $a$ and
    \begin{equation*}
        (f\circ g)'(a) = f'(g(a))\cdot g'(a)
    \end{equation*}
    \begin{proof}
        To prove that $f\circ g$ is differentiable at $a$, Theorem \ref{trm:12.4} tells us that it will suffice to show that $\lim_{x\to a}\frac{(f\circ g)(x)-(f\circ g)(a)}{x-a}$ exists. To do so, we will define a special function $\varphi$ and prove that it is continuous at $a$. It will follow that $(f\circ g)'(a)$ exists and equals $f'(g(a))\cdot g'(a)$. Let's begin.\par
        Let $\varphi:I\to\R$ be defined by
        \begin{equation*}
            \varphi(x) =
            \begin{cases}
                \frac{f(g(x))-f(g(a))}{g(x)-g(a)} & g(x)\neq g(a)\\
                f'(g(a)) & g(x)=g(a)
            \end{cases}
        \end{equation*}
        It is clear from the definition that the function is defined for all $x\in A$.\par
        To demonstrate that $\varphi$ is continuous at $a$, Theorem \ref{trm:11.5} tells us that it will suffice to confirm that for every $\epsilon>0$, there exists a $\delta>0$ such that if $x\in A$ and $|x-a|<\delta$, then $|\varphi(x)-\varphi(a)|=|\varphi(x)-f'(g(a))|<\epsilon$. Let $\epsilon>0$ be arbitrary. Since $f$ is differentiable at $g(a)$, we know that $\lim_{y\to g(a)}\frac{f(y)-f(g(a))}{y-g(a)}=f'(g(a))$. It follows by Definition \ref{dfn:11.1} that there is some $\delta'>0$ such that if $y\in I$ and $0<|y-g(a)|<\delta'$, then $|\frac{f(y)-f(g(a))}{y-g(a)}-f'(g(a))|<\epsilon$. Additionally, since $g$ is differentiable (hence continuous by Theorem \ref{trm:12.5}) at $a$, we have by Theorem \ref{trm:11.5} that there exists a $\delta>0$ such that if $x\in A$ and $|x-a|<\delta$, then $|g(x)-g(a)|<\delta'$.\par
        Using the above $\delta$, let $x$ be an arbitrary element of $A$ such that $|x-a|<\delta$. We now divide into two cases ($g(x)=g(a)$ and $g(x)\neq g(a)$). If $g(x)=g(a)$, then $|\varphi(x)-f'(g(a))|=|f'(g(a))-f'(g(a))|=0<\epsilon$, as desired. If $g(x)\neq g(a)$, then we continue. Since $|x-a|<\delta$, we have that $|g(x)-g(a)|<\delta'$. This combined with the fact that $g(x)\in I$ and $g(x)\neq g(a)$, i.e., $0<|g(x)-g(a)|$ illustrates that $|\frac{f(g(x))-f(g(a))}{g(x)-g(a)}-f'(g(a))|=|\varphi(x)-f'(g(a))|<\epsilon$. Therefore, $\varphi$ is continuous at $a$.\par
        It follows by Theorem \ref{trm:11.5} that $\lim_{x\to a}\varphi(x)=\varphi(a)=f'(g(a))$. Additionally, since $g$ is differentiable at $a$, Definition \ref{dfn:12.1} and Theorem \ref{trm:12.4} tell us that $\lim_{x\to a}\frac{g(x)-g(a)}{x-a}$ exists (and equals $g'(a)$). The combination of the past two results imply by Theorem \ref{trm:11.9} that the product of the limits exists and equals
        \begin{align*}
            f'(g(a))\cdot g'(a) &= \lim_{x\to a}\varphi(x)\cdot\frac{g(x)-g(a)}{x-a}\\
            &= \lim_{x\to a}\frac{f(g(x))-f(g(a))}{g(x)-g(a)}\cdot\frac{g(x)-g(a)}{x-a}\\
            &= \lim_{x\to a}\frac{f(g(x))-f(g(a))}{x-a}\\
            &= \lim_{x\to a}\frac{(f\circ g)(x)-(f\circ g)(a)}{x-a}\\
            &= (f\circ g)'(a)
        \end{align*}
        as desired.
    \end{proof}
\end{theorem}

We now come to the most important theorem in differential calculus, Corollary \ref{cly:12.16}.

\begin{definition}\label{dfn:12.11}
    Let $f:A\to\R$ be a function. If $f(a)$ is the last point of $f(A)$, then $f(a)$ is called the \textbf{maximum value} of $f$. If $f(a)$ is the first point of $f(A)$, then $f(a)$ is the \textbf{minimum value} of $f$. We say that $f(a)$ is a \textbf{local maximum value} of $f$ if there exists a region $R$ containing $a$ such that $f(a)$ is the last point of $f(A\cap R)$. We say that $f(a)$ is a \textbf{local minimum value} of $f$ if there exists a region $R$ containing $a$ such that $f(a)$ is the first point of $f(A\cap R)$.
\end{definition}

\begin{remark}\label{rmk:12.12}
    Equivalently, $f(a)$ is a local maximum (resp. minimum) value of $f$ if there exists $U$ open in $A$ such that $f(a)$ is the last (resp. first) point of $f(U)$.
\end{remark}

\begin{theorem}\label{trm:12.13}
    Let $f:A\to\R$ be differentiable at $a$. Suppose that $f(a)$ is the maximum value or minimum value of $f$. Then $f'(a)=0$.
    \begin{proof}
        Suppose first that $f(a)$ is the maximum value of $f$, and suppose for the sake of contradiction that $f'(a)\neq 0$. Then $f'(a)>0$ or $f'(a)<0$. We now divide into two cases. If $\lim_{x\to a}\frac{f(x)-f(a)}{x-a}=f'(a)>0$, then for $\epsilon=f'(a)$, we have by Definition \ref{dfn:11.1} that there exists a $\delta>0$ such that if $x\in A$ and $0<|x-a|<\delta$, then $|\frac{f(x)-f(a)}{x-a}-f'(a)|<f'(a)$. Let $x_0\in A$ satisfy $0<x-a<\delta$. Then by Definition \ref{dfn:8.4}, $0<|x_0-a|<\delta$. Consequently, $|\frac{f(x_0)-f(a)}{x_0-a}-f'(a)|<f'(a)$. It follows by the lemma from Exercise \ref{exr:8.9} that $-f'(a)<\frac{f(x_0)-f(a)}{x_0-a}-f'(a)<f'(a)$. Thus, by Script \ref{sct:7}, we have that $0<\frac{f(x_0)-f(a)}{x_0-a}$, implying since $x-a>0$ that $0<f(x_0)-f(a)$. But this means that $f(x_0)>f(a)$, i.e., that $f(a)$ is not the last point of $f(A)$ (by Definition \ref{dfn:3.3}), i.e., that $f(a)$ is not the maximum value of $f$ (by Definition \ref{dfn:12.11}), a contradiction. The argument is symmetric in the other case.\par
        The proof is symmetric in the other case.
    \end{proof}
\end{theorem}

\begin{corollary}\label{cly:12.14}
    Let $f:A\to\R$ be differentiable at $a$. Suppose that $f(a)$ is a local maximum or local minimum value of $f$. Then $f'(a)=0$.
    \begin{proof}
        Suppose first that $f(a)$ is a local maximum of $f$. Then by Definition \ref{dfn:12.11}, there exists a region $R$ containing $a$ such that $f(a)$ is the last point of $f(A\cap R)$. Now consider the restriction of $f$ to $A\cap R$. It follows from Definition \ref{dfn:9.6} that $f|_{A\cap R}$ is differentiable at $a$, that $f|_{A\cap R}(A\cap R)=f(A\cap R)$, and that $f_{A\cap R}(a)=f(a)$ is the last point of $f|_{A\cap R}(A\cap R)$. The latter two results imply by Definition \ref{dfn:12.11} that $f_{A\cap R}(a)$ is the maximum value of $f|_{A\cap R}$. This combined with the fact that $f|_{A\cap R}$ is differentiable at $a$ implies by Theorem \ref{trm:12.13} that $f|_{A\cap R}'(a)=f'(a)=0$, as desired.
    \end{proof}
\end{corollary}

\begin{theorem}\label{trm:12.15}
    Suppose that $f:[a,b]\to\R$ is continuous, differentiable on $(a,b)$, and that $f(a)=f(b)=0$. Then there exists a point $\lambda\in(a,b)$ such that $f'(\lambda)=0$.
    \begin{proof}
        We divide into two cases ($f(x)=0$ for all $x\in[a,b]$, and $f(x)\neq 0$ for some $x\in[a,b]$).\par
        Suppose first that $f(x)=0$ for all $x\in[a,b]$. By Theorem \ref{trm:5.2}, we can choose a $\lambda\in(a,b)$. It follows from the hypothesis that $f(\lambda)=f(x)$ for all $f(x)\in f([a,b])$. This can be weakened to $f(\lambda)\geq f(x)$ for all $f(x)\in f([a,b])$. Thus, by Definition \ref{dfn:3.3}, $f(\lambda)$ is the last point of $f([a,b])$. Consequently, by Definition \ref{dfn:12.11}, $f(\lambda)$ is the maximum value of $f$. This combined with the fact that $f$ is differentiable at $\lambda$ (since $\lambda\in(a,b)$ and $f$ is differentiable on $(a,b)$) implies by Theorem \ref{trm:12.13} that $f'(\lambda)=0$, as desired.\par
        Now suppose that $f(x)\neq 0$ for some $x\in[a,b]$ which we shall call $x_0$. We divide into two cases again ($f(x_0)>0$ and $f(x_0)<0$). If $f(x_0)>0$, then by Exercise \ref{exr:10.21}, there exists a point $\lambda\in[a,b]$ such that $f(\lambda)\geq f(x)$ for all $x\in[a,b]$. It follows that $f(\lambda)\geq f(x_0)>0$, so $f(\lambda)\neq f(a)=f(b)$. Thus, by Definition \ref{dfn:1.16}, $\lambda\neq a$ and $\lambda\neq b$. This combined with the fact that $\lambda\in[a,b]$ implies by Script \ref{sct:8} that $\lambda\in(a,b)$. Now as before, we can determine from the fact that $f(\lambda)\geq f(x)$ for all $x\in[a,b]$ that $f(\lambda)$ is the maximum value of $f$. This combined with the fact that $f$ is differentiable at $\lambda$ (since $\lambda\in(a,b)$ and $f$ is differentiable on $(a,b)$) implies by Theorem \ref{trm:12.13} that $f'(\lambda)=0$, as desired. The argument is symmetric in the other case.
    \end{proof}
\end{theorem}

\begin{corollary}\label{cly:12.16}
    Suppose that $f:[a,b]\to\R$ is continuous on $[a,b]$ and differentiable on $(a,b)$. Then there exists a point $\lambda\in(a,b)$ such that
    \begin{equation*}
        f(b)-f(a) = f'(\lambda)(b-a)
    \end{equation*}
    \begin{proof}
        Let $h:[a,b]\to\R$ be defined by
        \begin{equation*}
            h(x) = f(x)-\frac{f(b)-f(a)}{b-a}(x-a)-f(a)
        \end{equation*}
        By hypothesis, $f(x)$ is continuous on $[a,b]$. By Exercise \ref{exr:11.6} and Theorem \ref{trm:11.9}, $-\frac{f(b)-f(a)}{b-a}(x-a)-f(a)$ is continuous on $[a,b]$. Thus, by Theorem \ref{trm:11.9}, their sum (i.e., $h(x)$) is continuous on $[a,b]$. Additionally, by hypothesis, $f(x)$ is differentiable on $(a,b)$. By Exercises \ref{exr:12.8} and \ref{exr:12.9}, $-\frac{f(b)-f(a)}{b-a}(x-a)-f(a)$ is differentiable on $[a,b]$. Thus, by Exercise \ref{exr:12.9}, their sum (i.e., $h(x)$) is differentiable on $(a,b)$. Furthermore, by simple algebra, we can determine that
        \begin{align*}
            h(a) &= f(a)-\frac{f(b)-f(a)}{b-a}(a-a)-f(a)&
                h(b) &= f(b)-\frac{f(b)-f(a)}{b-a}(b-a)-f(a)\\
            &= -\frac{f(b)-f(a)}{b-a}\cdot 0&
                &= f(b)-(f(b)-f(a))-f(a)\\
            &= 0&
                &= 0
        \end{align*}
        Thus, by Theorem \ref{trm:12.15}, there exists a point $\lambda\in(a,b)$ such that $h'(\lambda)=0$.\par
        We can also calculate $h'(x)$ as follows.
        \begin{align*}
            h'(x) &= \left( f(x)-\frac{f(b)-f(a)}{b-a}(x-a)-f(a) \right)'\\
            &= \left( (f(x))+\left( -\frac{f(b)-f(a)}{b-a}\cdot x \right)+\left( \frac{f(b)-f(a)}{b-a}\cdot a-f(a) \right) \right)'\\
            &= f'(x)+\left( -\frac{f(b)-f(a)}{b-a}\cdot x \right)'+\left( \frac{f(b)-f(a)}{b-a}\cdot a-f(a) \right)'\tag*{Exercise \ref{exr:12.9}}\\
            &= f'(x)+\left( -\frac{f(b)-f(a)}{b-a} \right)'\cdot(x)+\left( -\frac{f(b)-f(a)}{b-a} \right)\cdot(x)'+\left( \frac{f(b)-f(a)}{b-a}\cdot a-f(a) \right)'\tag*{Exercise \ref{exr:12.9}}\\
            &= f'(x)+0\cdot x+\frac{f(b)-f(a)}{b-a}\cdot 1x^0+0\tag*{Exercise \ref{exr:12.8}}\\
            &= f'(x)+\frac{f(b)-f(a)}{b-a}
        \end{align*}
        But it follows that at $\lambda$,
        \begin{align*}
            0 &= f'(\lambda)-\frac{f(b)-f(a)}{b-a}\\
            \frac{f(b)-f(a)}{b-a} &= f'(\lambda)\\
            f(b)-f(a) &= f'(\lambda)(b-a)
        \end{align*}
        as desired.
    \end{proof}
\end{corollary}




\end{document}